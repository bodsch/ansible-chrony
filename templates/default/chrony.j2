#jinja2: trim_blocks: True, lstrip_blocks: True
# {{ ansible_managed }}

# Options to pass to chrony.
DAEMON_OPTS="
{% if chrony_daemon_args.use_ipv4_only is defined and
      chrony_daemon_args.use_ipv4_only | string | length > 0 and
      chrony_daemon_args.use_ipv4_only %}
  -4 \
{% endif %}
{% if chrony_daemon_args.use_ipv6_only is defined and
      chrony_daemon_args.use_ipv6_only | string | length > 0 and
      chrony_daemon_args.use_ipv6_only %}
  -6 \
{% endif %}
{% if chrony_daemon_args.run_as_daemon is defined and
      chrony_daemon_args.run_as_daemon | string | length > 0 and
      not chrony_daemon_args.run_as_daemon %}
  -d \
{% endif %}
  -l {{ chrony_config.log.directory }}/chrony.log \
{% if chrony_daemon_args.logging_threshold is defined and
      chrony_daemon_args.logging_threshold | string | length > 0 and
      chrony_daemon_args.logging_threshold | int in [0,1,2,3] %}
  -L {{ chrony_daemon_args.logging_threshold }} \
{% endif %}
{% if chrony_daemon_args.reload_dump_files is defined and
      chrony_daemon_args.reload_dump_files %}
  -r \
{% endif %}
{% if chrony_daemon_args.seccomp_filter_level is defined and
      chrony_daemon_args.seccomp_filter_level | int in [0,1,2] %}
  -F {{ chrony_daemon_args.seccomp_filter_level }} \
{% endif %}
{% if chrony_daemon_args.dont_check_for_root is defined and
      chrony_daemon_args.dont_check_for_root %}
  -U \
{% endif %}
{% if chrony_daemon_args.run_as_user is defined and
      chrony_daemon_args.run_as_user | string | length > 0 %}
  -u {{ chrony_daemon_args.run_as_user }} \
{% endif %}
  -f {{ chrony_config_file }}
"

# -F 1 -u chrony -l {{ chrony_config.log.directory }}/chrony.log -f {{ chrony_config_file }} -r"

# /usr/sbin/chronyd --help
# Usage: /usr/sbin/chronyd [OPTION]... [DIRECTIVE]...
#
# Options:
#   -4            Use IPv4 addresses only
#   -6            Use IPv6 addresses only
#   -f FILE       Specify configuration file (/etc/chrony/chrony.conf)
#   -n            Don't run as daemon
#   -d            Don't run as daemon and log to stderr
#   -l FILE       Log to file
#   -L LEVEL      Set logging threshold (0)
#   -p            Print configuration and exit
#   -q            Set clock and exit
#   -Q            Log offset and exit
#   -r            Reload dump files
#   -R            Adapt configuration for restart
#   -s            Set clock from RTC
#   -t SECONDS    Exit after elapsed time
#   -u USER       Specify user (_chrony)
#   -U            Don't check for root
#   -F LEVEL      Set system call filter level (0)
#   -P PRIORITY   Set process priority (0)
#   -m            Lock memory
#   -x            Don't control clock
#   -v, --version Print version and exit
#   -h, --help    Print usage and exit
